<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Booking Form</title>
    <link rel="stylesheet" href="form.css">
</head>
<body>
    <div class="form-container">
        <div class="form-header">
            <h2>Booking Form</h2>
        </div>
        <!-- First Section -->
        <div class="form-wrapper">
            <div class="form-section">
                <div class="form-group">
                    <label for="formNo">Form No: 1</label>
                </div>
                <div class="form-group">
                    <label id="dateLabel">Date:</label>
                </div>
            </div>
            <!-- Logo -->
            <div class="logo">
                <img src="./image/logo1.png" alt="Your Logo">
            </div>
        </div>
        
        <!-- Second Section -->
        <div class="form-section1">
            <div class="form-column">
                <div class="form-group1">
                    <label for="studentName">Student Name:</label>
                    <input type="text" id="studentName" name="studentName">
                </div>
                <div class="form-group1">
                    <label for="dob">Date of Birth:</label>
                    <input type="date" id="dob" name="dob">
                </div>
                <div class="form-group1">
                    <label for="studentEmail">Student's Email:</label>
                    <input type="email" id="studentEmail" name="studentEmail">
                </div>
                <div class="form-group1">
                    <label for="school">School:</label>
                    <input type="text" id="school" name="school">
                </div>
                <div class="form-group1">
                    <label for="board">Board:</label>
                    <input type="text" id="board" name="board">
                </div>
            </div>
            <div class="form-column">
                <div class="form-group1">
                    <label for="mobile">Mobile:</label>
                    <input type="tel" id="mobile" name="mobile">
                </div>
                <div class="form-group1">
                    <label for="parentName">Parent's Name:</label>
                    <input type="text" id="parentName" name="parentName">
                </div>
                <div class="form-group1">
                    <label for="parentEmail">Parent's Email:</label>
                    <input type="email" id="parentEmail" name="parentEmail">
                </div>
                <div class="form-group1">
                    <label for="parentMobile">Parent's Mobile:</label>
                    <input type="tel" id="parentMobile" name="parentMobile">
                </div>
                <div class="form-group1">
                    <label for="address">Address:</label>
                    <input type="text" id="address" name="address">
                </div>
            </div>
        </div>
        
        <!-- Third Section with Grid Layout -->
        <div class="form-section grid-layout">
            <!-- Left Column -->
            <div class="left-column">
                <!-- Course Enrolment -->
                <button type="button" class="accordion">Course Enrolment</button>
                <div class="accordion-content">
                    <div class="form-group-checkbox">
                        <input type="checkbox" id="dambaruuApp" name="course" value="DambaruuApp">
                        <label for="dambaruuApp">Dambaruu app</label>
                    </div>
                    <div class="form-group-checkbox">
                        <input type="checkbox" id="homeLearningKit" name="course" value="HomeLearningKit">
                        <label for="homeLearningKit">Home Learning Kit</label>
                    </div>
                </div>
                <!-- Class -->
                <button type="button" class="accordion">Class</button>
                <div class="accordion-content">
                    <div class="form-group-radio">
                        <input type="radio" id="nursery" name="class" value="NURSERY">
                        <label for="nursery">NURSERY</label>
                    </div>
                    <div class="form-group-radio">
                        <input type="radio" id="lkg" name="class" value="LKG">
                        <label for="lkg">LKG</label>
                    </div>
                    <div class="form-group-radio">
                        <input type="radio" id="ukg" name="class" value="UKG">
                        <label for="ukg">UKG</label>
                    </div>
                </div>
                <!-- Course Plan -->
                <button type="button" class="accordion">Course Plan</button>
                <div class="accordion-content">
                    <div class="form-group-radio">
                        <input type="radio" id="oneYear" name="coursePlan" value="1_year">
                        <label for="oneYear">1 year</label>
                    </div>
                    <div class="form-group-radio">
                        <input type="radio" id="twoYear" name="coursePlan" value="2_year">
                        <label for="twoYear">2 year</label>
                    </div>
                    <div class="form-group-radio">
                        <input type="radio" id="threeYear" name="coursePlan" value="3_year">
                        <label for="threeYear">3 year</label>
                    </div>
                </div>
                <!-- Payment Information -->
                <button type="button" class="accordion">Payment Information</button>
                <div class="accordion-content">
                    <div class="form-column">
                        <div class="form-group1">
                            <label for="totalAmount">Total Amount:</label>
                            <input type="text" id="totalAmount" name="totalAmount">
                        </div>
                        <div class="form-group1">
                            <label for="advancePaid">Advance paid</label>
                            <input type="text" id="advancePaid" name="advancePaid">
                        </div>
                        <div class="form-group1">
                            <label for="paymentDues">Payment Dues:</label>
                            <input type="text" id="paymentDues" name="paymentDues">
                        </div>
                    </div>
                </div>
                <!-- File Uploads -->
                <div class="form-section">
                    <div class="form-group">
                        <label for="photoUpload">Upload Photo:</label>
                        <input type="file" id="photoUpload" name="photoUpload" accept="image/*" capture="camera">
                    </div>
                    <div class="form-group">
                        <label for="aadhaarUpload">Upload Aadhaar:</label>
                        <input type="file" id="aadhaarUpload" name="aadhaarUpload" accept="application/pdf,image/*">
                    </div>
                </div>
            </div>
            <!-- Right Column -->
            <div class="right-column">
                <img src="./image/img.png" id="uploadedImage" />
            </div>
        </div>

        <!-- Footer Section -->
        <div class="form-section1" style="border: none;">
            <div class="form-column">
                <div class="form-group">
                    <label>Signature of parent:</label>
                    <canvas id="parentSignature" class="signature-pad" width="300" height="100" style="border: 1px solid #000;"></canvas>
                    <button type="button" onclick="clearCanvas('parentSignature')">Clear</button>
                    <button type="button" onclick="uploadSignature('parentSignature', 'parentSignatureUpload')">Upload</button>
                    <input type="file" id="parentSignatureUpload" name="parentSignatureUpload" style="display:none;">
                </div>
            </div>
            <div class="form-column">
                <div class="form-group">
                    <label>Signature of BDE:</label>
                    <canvas id="bdeSignature" class="signature-pad" width="300" height="100" style="border: 1px solid #000;"></canvas>
                    <button type="button" onclick="clearCanvas('bdeSignature')">Clear</button>
                    <button type="button" onclick="uploadSignature('bdeSignature', 'bdeSignatureUpload')">Upload</button>
                    <input type="file" id="bdeSignatureUpload" name="bdeSignatureUpload" style="display:none;">
                </div>
            </div>
        </div>

        <!-- Declaration -->
        <button type="button" style="width:20rem;height: 2rem;border: none; background-color:#00796b;">Declaration</button>
        <div class="declaration">
            <p>I, <input type="text" id="parentNameInput" class="declaration-field">, hereby give my consent to my child of Class <input type="text" id="classInput" class="declaration-field"> to participate in the DAMBARUU's online Home Learning program for the duration of <input type="text" class="declaration-field" id="durationInput"> year/(s). I have reviewed and agree to the terms of the service, privacy policy, payment terms, and any other relevant policies of DAMBARUU.</p>
        </div>

        <!-- Submit Button -->
        <div class="form-group">
            <button type="button" onclick="submitForm()" style="width:20rem;height: 3rem; background-color:#00796b;">Submit</button>
        </div>
    </div>
    <script src="form.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/signature_pad@4.1.7/dist/signature_pad.umd.min.js"></script>
    <script>
        // Initialize signature pads
        var parentSignaturePad = new SignaturePad(document.getElementById('parentSignature'));
        var bdeSignaturePad = new SignaturePad(document.getElementById('bdeSignature'));

        function clearCanvas(canvasId) {
            var canvas = document.getElementById(canvasId);
            var context = canvas.getContext('2d');
            context.clearRect(0, 0, canvas.width, canvas.height);
        }

    

        function dataURItoBlob(dataURI) {
            var byteString = atob(dataURI.split(',')[1]);
            var mimeString = dataURI.split(',')[0].split(':')[1].split(';')[0];
            var ab = new ArrayBuffer(byteString.length);
            var ia = new Uint8Array(ab);
            for (var i = 0; i < byteString.length; i++) {
                ia[i] = byteString.charCodeAt(i);
            }
            return new Blob([ab], { type: mimeString });
        }

        function submitForm() {
            var formData = new FormData();
            formData.append('student_name', document.getElementById('studentName').value);
            formData.append('student_dob ', document.getElementById('dob').value);
            formData.append('student_email', document.getElementById('studentEmail').value);
            formData.append('student_school', document.getElementById('school').value);
            formData.append('student_board', document.getElementById('board').value);
            formData.append('student_mobile', document.getElementById('mobile').value);
            formData.append('parent_name', document.getElementById('parentName').value);
            formData.append('parent_email ', document.getElementById('parentEmail').value);
            formData.append('parent_mobile', document.getElementById('parentMobile').value);
            formData.append('address ', document.getElementById('address').value);

            // Collecting checkbox values
            var courses = document.querySelectorAll('input[name="course"]:checked');
            courses.forEach((course) => {
                formData.append('course', course.value);
            });

             // Append selected radio for class
    var student_class = document.querySelector('input[name="class"]:checked');
    if (student_class) {
        formData.append('student_class', student_class.value);
    }

    // Append selected radio for course plan
    var course_plan = document.querySelector('input[name="coursePlan"]:checked');
    if (course_plan) {
        formData.append('course_plan', course_plan.value);
    }
            // formData.append('totalAmount', document.getElementById('totalAmount').value);
            // formData.append('advancePaid', document.getElementById('advancePaid').value);
            // formData.append('paymentDues', document.getElementById('paymentDues').value);

            formData.append('photo', document.getElementById('photoUpload').files[0]);
            formData.append('aadhar_proof', document.getElementById('aadhaarUpload').files[0]);

            formData.append('signature_parent', document.getElementById('parentSignatureUpload').files[0]);
            formData.append('signature_bde', document.getElementById('bdeSignatureUpload').files[0]);

            // formData.append('parentNameInput', document.getElementById('parentNameInput').value);
            // formData.append('classInput', document.getElementById('classInput').value);
            // formData.append('durationInput', document.getElementById('durationInput').value);

            // Send the form data to the endpoint
            fetch('http://192.168.0.116:8000/booking/', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                console.log('Success:', data);
            })
            .catch((error) => {
                console.error('Error:', error);
            });
        }
    </script>
</body>
</html>
